# ArrayEditor 组件使用说明

## 功能概述

`ArrayEditor` 是一个专门用于编辑数组字段的组件，提供了直观的可视化界面，让用户可以方便地管理数组元素。

## 特性

### 1. 不定长数组

对于 `fixedLength` 未设置或为 0 的数组字段，提供完整的数组操作功能：

- ✅ **添加元素**：点击"➕ 添加元素"按钮，自动添加一个该数组元素类型的默认值
- ✅ **删除元素**：点击元素右侧的 🗑️ 按钮，删除指定元素
- ✅ **调整顺序**：使用 ▲ 和 ▼ 按钮上移或下移元素
- ✅ **空数组**：初始状态为空数组，需要手动添加元素

### 2. 定长数组

对于设置了 `fixedLength` 的数组字段，提供受限的编辑功能：

- ✅ **固定长度**：打开编辑器时自动初始化为指定长度的数组
- ✅ **默认值**：每个元素都填充为该类型的默认值
- ✅ **调整顺序**：可以使用 ▲ 和 ▼ 按钮调整元素顺序
- ❌ **不可添加**：没有"添加元素"按钮
- ❌ **不可删除**：没有删除按钮

## 使用示例

### 在字段定义中使用

```typescript
import type { IArrayField } from '../utils/types';

// 不定长数组示例
const dynamicArrayField: IArrayField = {
  key: 'tags',
  name: '标签列表',
  type: 'array',
  element: {
    type: 'string',
    key: 'tag',
    name: '标签'
  }
  // fixedLength 未设置，默认为不定长
};

// 定长数组示例
const fixedArrayField: IArrayField = {
  key: 'scores',
  name: '成绩（5项）',
  type: 'array',
  element: {
    type: 'number',
    key: 'score',
    name: '分数',
    defaultValue: 0
  },
  fixedLength: 5  // 固定长度为 5
};
```

### 在 FieldInput 中自动使用

`ArrayEditor` 组件已集成到 `FieldInput` 中，当字段类型为 `array` 时会自动使用：

```vue
<FieldInput
  v-model="value"
  :field="arrayField"
/>
```

## 支持的元素类型

`ArrayEditor` 支持所有字段类型作为数组元素：

- `string` - 字符串
- `number` - 数字
- `boolean` - 布尔值
- `select` - 下拉选择
- `reward` - 奖励对象
- `array` - 嵌套数组
- `object` - 对象

## 界面说明

```
┌─────────────────────────────────────────────────┐
│ 不定长数组 (3 项)              [➕ 添加元素]    │
├─────────────────────────────────────────────────┤
│ ┌─────────────────────────────────────────────┐ │
│ │ #1                       [▲] [▼] [🗑️]      │ │
│ │ ┌─────────────────────────────────────────┐ │ │
│ │ │ 元素输入框                               │ │ │
│ │ └─────────────────────────────────────────┘ │ │
│ └─────────────────────────────────────────────┘ │
│ ┌─────────────────────────────────────────────┐ │
│ │ #2                       [▲] [▼] [🗑️]      │ │
│ │ └── 元素输入框                               │ │
│ └─────────────────────────────────────────────┘ │
│ ┌─────────────────────────────────────────────┐ │
│ │ #3                       [▲] [▼] [🗑️]      │ │
│ │ └── 元素输入框                               │ │
│ └─────────────────────────────────────────────┘ │
└─────────────────────────────────────────────────┘
```

## 样式特点

- 🎨 **深色主题**：与编辑器整体风格一致
- 📏 **最大高度限制**：最高 400px，超出后显示滚动条
- 🎯 **清晰的视觉层次**：每个数组元素有独立的卡片容器
- ⚡ **流畅的交互**：按钮 hover 效果和禁用状态
- 📱 **响应式设计**：适配不同尺寸的面板

## 技术实现

- **框架**：Vue 3 Composition API
- **类型安全**：完整的 TypeScript 类型定义
- **响应式数据**：通过 `v-model` 实现双向绑定
- **递归组件**：支持嵌套数组和对象
- **深拷贝**：使用 `JSON.parse(JSON.stringify())` 创建默认值副本

## 注意事项

1. **初始化时机**：定长数组在组件挂载时自动初始化，如果数组为空会填充默认值
2. **删除确认**：删除元素前会弹出确认对话框，避免误操作
3. **顺序调整**：第一个元素不能上移，最后一个元素不能下移
4. **类型匹配**：元素类型必须与 `element` 字段定义一致
