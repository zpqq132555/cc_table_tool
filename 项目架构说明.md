# Table Tool é¡¹ç›®æ¶æ„è¯´æ˜

## ğŸ“‹ ç›®å½•
- [é¡¹ç›®æ¦‚è¿°](#é¡¹ç›®æ¦‚è¿°)
- [æŠ€æœ¯æ ˆ](#æŠ€æœ¯æ ˆ)
- [æ¶æ„è®¾è®¡](#æ¶æ„è®¾è®¡)
- [ç›®å½•ç»“æ„](#ç›®å½•ç»“æ„)
- [æ ¸å¿ƒæ¨¡å—](#æ ¸å¿ƒæ¨¡å—)
- [å¼€å‘è§„èŒƒ](#å¼€å‘è§„èŒƒ)
- [æ•°æ®æµç¨‹](#æ•°æ®æµç¨‹)

---

## é¡¹ç›®æ¦‚è¿°

Table Tool æ˜¯ä¸€ä¸ª **Cocos Creator è·¨ç‰ˆæœ¬æ’ä»¶æ¡†æ¶**ï¼Œæ ¸å¿ƒæ˜¯ **Vue æ•°æ®ç¼–è¾‘å™¨**ã€‚

### è®¾è®¡ç†å¿µ

```
â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘  å…³æ³¨ç‚¹åˆ†ç¦»ï¼šæ¡†æ¶å±‚ vs ä¸šåŠ¡å±‚                                â•‘
â• â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•£
â•‘  æ¡†æ¶å±‚ï¼ˆå·²å®Œæˆï¼‰         â†’  å¼€å‘è€…æ— éœ€å…³å¿ƒ                  â•‘
â•‘  - ç‰ˆæœ¬æ£€æµ‹                                                 â•‘
â•‘  - é€‚é…å™¨å·¥å‚                                               â•‘
â•‘  - v2/v3 API é€‚é…                                          â•‘
â•‘  - IPC é€šä¿¡æ¡¥æ¥                                             â•‘
â•‘                                                             â•‘
â•‘  ä¸šåŠ¡å±‚ï¼ˆå¼€å‘é‡ç‚¹ï¼‰       â†’  å¼€å‘è€…ä¸»è¦å·¥ä½œåŒº                 â•‘
â•‘  - Vue ç¼–è¾‘å™¨ UI                                           â•‘
â•‘  - æ•°æ®ç®¡ç†é€»è¾‘                                             â•‘
â•‘  - ç»„ä»¶åŠŸèƒ½å®ç°                                             â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
```

### æ ¸å¿ƒç‰¹æ€§

- âœ… **å››ç§è¿è¡Œæ¨¡å¼**ï¼šStandalone / Electron / Cocos 2.x / Cocos 3.x
- âœ… **ç»Ÿä¸€ API æ¥å£**ï¼šæ¡†æ¶è‡ªåŠ¨é€‚é…ä¸åŒè¿è¡Œç¯å¢ƒ
- âœ… **Vue æ•°æ®ç¼–è¾‘å™¨**ï¼šå®Œæ•´çš„è¡¨æ ¼æ•°æ®ç®¡ç†ç³»ç»Ÿ
- âœ… **åŠ å¯†å­˜å‚¨**ï¼š.table äºŒè¿›åˆ¶æ ¼å¼

---

## æŠ€æœ¯æ ˆ

### æ¡†æ¶å±‚
- **TypeScript** - ç±»å‹å®‰å…¨
- **é€‚é…å™¨æ¨¡å¼** - è·¨ç‰ˆæœ¬å…¼å®¹
- **å·¥å‚æ¨¡å¼** - åŠ¨æ€åˆ›å»ºé€‚é…å™¨

### ä¸šåŠ¡å±‚ï¼ˆVue ç¼–è¾‘å™¨ï¼‰
- **Vue 2.x** - æ¸è¿›å¼æ¡†æ¶ï¼ˆå…¼å®¹ Cocos 2.x/3.xï¼‰
- **Vite** - å¿«é€Ÿå¼€å‘æ„å»º
- **TypeScript** - ç±»å‹å®šä¹‰

### æ‰“åŒ…å·¥å…·
- **Electron** - ç‹¬ç«‹æ¡Œé¢åº”ç”¨
- **electron-builder** - æ‰“åŒ… exe

---

## æ¶æ„è®¾è®¡

### æ•´ä½“æ¶æ„

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                   Table Tool æ’ä»¶                           â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚                  Vue æ•°æ®ç¼–è¾‘å™¨                        â”‚  â”‚
â”‚  â”‚            (src/panels/vue-editor/)                   â”‚  â”‚
â”‚  â”‚                                                       â”‚  â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚  â”‚
â”‚  â”‚  â”‚ ç»Ÿä¸€ API æ¥å£å±‚ (api/index.ts)                  â”‚  â”‚  â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚  â”‚
â”‚  â”‚              â”‚              â”‚              â”‚          â”‚  â”‚
â”‚  â”‚              â–¼              â–¼              â–¼          â”‚  â”‚
â”‚  â”‚    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚  â”‚
â”‚  â”‚    â”‚ standalone.tsâ”‚ â”‚  cocos.ts    â”‚ â”‚ electron.ts  â”‚ â”‚  â”‚
â”‚  â”‚    â”‚ (æµè§ˆå™¨API)   â”‚ â”‚  (IPCé€šä¿¡)   â”‚ â”‚  (IPCé€šä¿¡)   â”‚ â”‚  â”‚
â”‚  â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚              ä¸»è¿›ç¨‹ï¼ˆNode.js ç¯å¢ƒï¼‰                     â”‚  â”‚
â”‚  â”‚                (src/main.ts)                          â”‚  â”‚
â”‚  â”‚                                                       â”‚  â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚  â”‚
â”‚  â”‚  â”‚ é€‚é…å™¨å·¥å‚ (core/factory.ts)                    â”‚  â”‚  â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚  â”‚
â”‚  â”‚              â”‚                        â”‚                â”‚  â”‚
â”‚  â”‚              â–¼                        â–¼                â”‚  â”‚
â”‚  â”‚    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”‚  â”‚
â”‚  â”‚    â”‚  v2 é€‚é…å™¨       â”‚    â”‚  v3 é€‚é…å™¨       â”‚       â”‚  â”‚
â”‚  â”‚    â”‚ (adapters/v2/)  â”‚    â”‚ (adapters/v3/)  â”‚       â”‚  â”‚
â”‚  â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### å…³é”®è®¾è®¡ç‚¹

#### 1. ç¯å¢ƒåˆ†ç¦»

**ä¸»è¿›ç¨‹ï¼ˆNode.jsï¼‰**ï¼š
- ä½ç½®ï¼š`src/main.ts` + `src/adapters/`
- èŒè´£ï¼šå¤„ç† Cocos v2/v3 ç‰ˆæœ¬å·®å¼‚
- èƒ½åŠ›ï¼šå®Œæ•´çš„ Node.js API + Cocos Editor API

**Vue é¢æ¿ï¼ˆiframe æµè§ˆå™¨ç¯å¢ƒï¼‰**ï¼š
- ä½ç½®ï¼š`src/panels/vue-editor/src/`
- èŒè´£ï¼šUI æ¸²æŸ“å’Œç”¨æˆ·äº¤äº’
- é™åˆ¶ï¼šæ— æ³•ç›´æ¥è®¿é—® Node.js æ¨¡å—

#### 2. IPC æ¡¥æ¥

Vue é¢æ¿é€šè¿‡ IPC è°ƒç”¨ä¸»è¿›ç¨‹åŠŸèƒ½ï¼š

```typescript
// Vue é¢æ¿ (src/panels/vue-editor/src/api/cocos.ts)
function sendToMain(method: string, ...args: any[]) {
    // v3: Editor.Message.request('cc-table-tool', method, ...args)
    // v2: Editor.Ipc.sendToMain('cc-table-tool:' + method, ...args)
}

// ä¸»è¿›ç¨‹ (src/main.ts)
export const messages = {
    'select-file': async (options) => {
        const adapter = getEditor(); // ä½¿ç”¨é€‚é…å™¨å·¥å‚
        return adapter.selectFile(options);
    }
};
```

#### 3. å¹³å° API ç»Ÿä¸€

```typescript
// src/panels/vue-editor/src/api/index.ts
export interface IEditorApi {
    readFile(path: string): Promise<string>;
    writeFile(path: string, content: string): Promise<void>;
    selectFile(options?: any): Promise<string | null>;
    // ...
}

// ä¸åŒå¹³å°å®ç°
cocos.ts      â†’ IPC è°ƒç”¨ä¸»è¿›ç¨‹é€‚é…å™¨
electron.ts   â†’ IPC è°ƒç”¨ä¸»è¿›ç¨‹
standalone.ts â†’ æµè§ˆå™¨ FileSystemAccess API
```

---

## ç›®å½•ç»“æ„

```
cc_table_tool/
â”œâ”€â”€ src/                          # ä¸»è¿›ç¨‹æºä»£ç 
â”‚   â”œâ”€â”€ main.ts                   # æ’ä»¶å…¥å£
â”‚   â”œâ”€â”€ index.ts                  # ç»Ÿä¸€å¯¼å‡º
â”‚   â”‚
â”‚   â”œâ”€â”€ core/                     # ğŸ”’ æ¡†æ¶å±‚ï¼ˆå·²å®Œæˆï¼Œå¼€å‘è€…æ— éœ€ä¿®æ”¹ï¼‰
â”‚   â”‚   â”œâ”€â”€ interfaces.ts         # è·¨ç‰ˆæœ¬æŠ½è±¡æ¥å£
â”‚   â”‚   â”œâ”€â”€ version-detector.ts   # ç‰ˆæœ¬æ£€æµ‹å™¨
â”‚   â”‚   â”œâ”€â”€ factory.ts            # é€‚é…å™¨å·¥å‚
â”‚   â”‚   â”œâ”€â”€ base-plugin.ts        # åŸºç¡€æ’ä»¶ç±»
â”‚   â”‚   â””â”€â”€ index.ts              # ç»Ÿä¸€å¯¼å‡º
â”‚   â”‚
â”‚   â”œâ”€â”€ adapters/                 # ğŸ”’ æ¡†æ¶å±‚ï¼ˆå·²å®Œæˆï¼Œå¼€å‘è€…æ— éœ€ä¿®æ”¹ï¼‰
â”‚   â”‚   â”œâ”€â”€ v2/                   # Cocos 2.x é€‚é…å™¨
â”‚   â”‚   â”‚   â”œâ”€â”€ editor-adapter.ts
â”‚   â”‚   â”‚   â”œâ”€â”€ panel-adapter.ts
â”‚   â”‚   â”‚   â”œâ”€â”€ ipc-adapter.ts
â”‚   â”‚   â”‚   â”œâ”€â”€ asset-adapter.ts
â”‚   â”‚   â”‚   â”œâ”€â”€ scene-adapter.ts
â”‚   â”‚   â”‚   â””â”€â”€ index.ts
â”‚   â”‚   â””â”€â”€ v3/                   # Cocos 3.x é€‚é…å™¨
â”‚   â”‚       â”œâ”€â”€ editor-adapter.ts
â”‚   â”‚       â”œâ”€â”€ panel-adapter.ts
â”‚   â”‚       â”œâ”€â”€ ipc-adapter.ts
â”‚   â”‚       â”œâ”€â”€ asset-adapter.ts
â”‚   â”‚       â”œâ”€â”€ scene-adapter.ts
â”‚   â”‚       â””â”€â”€ index.ts
â”‚   â”‚
â”‚   â”œâ”€â”€ bridge/                   # ğŸ”’ æ¡†æ¶å±‚ï¼ˆå·²å®Œæˆï¼Œå¼€å‘è€…æ— éœ€ä¿®æ”¹ï¼‰
â”‚   â”‚   â”œâ”€â”€ cocos-bridge.ts       # Cocos é€šä¿¡æ¡¥æ¥
â”‚   â”‚   â”œâ”€â”€ types.ts              # æ¡¥æ¥ç±»å‹å®šä¹‰
â”‚   â”‚   â””â”€â”€ index.ts
â”‚   â”‚
â”‚   â”œâ”€â”€ panels/                   # é¢æ¿å®šä¹‰
â”‚   â”‚   â”œâ”€â”€ default/              # é»˜è®¤é¢æ¿ï¼ˆåŠ è½½ Vue ç¼–è¾‘å™¨ï¼‰
â”‚   â”‚   â””â”€â”€ vue-editor/           # â­ Vue æ•°æ®ç¼–è¾‘å™¨
â”‚   â”‚       â”œâ”€â”€ src/              # Vue æºä»£ç 
â”‚   â”‚       â”‚   â”œâ”€â”€ App.vue       # ä¸»åº”ç”¨ç»„ä»¶
â”‚   â”‚       â”‚   â”œâ”€â”€ main.ts       # Vue å…¥å£
â”‚   â”‚       â”‚   â”‚
â”‚   â”‚       â”‚   â”œâ”€â”€ api/          # ğŸ”‘ å¹³å°é€‚é…å±‚ï¼ˆç»Ÿä¸€ APIï¼‰
â”‚   â”‚       â”‚   â”‚   â”œâ”€â”€ index.ts  # API æ¥å£å®šä¹‰
â”‚   â”‚       â”‚   â”‚   â”œâ”€â”€ standalone.ts  # æµè§ˆå™¨å®ç°
â”‚   â”‚       â”‚   â”‚   â”œâ”€â”€ cocos.ts       # Cocos IPC å®ç°
â”‚   â”‚       â”‚   â”‚   â””â”€â”€ electron.ts    # Electron IPC å®ç°
â”‚   â”‚       â”‚   â”‚
â”‚   â”‚       â”‚   â”œâ”€â”€ components/   # Vue ç»„ä»¶
â”‚   â”‚       â”‚   â”‚   â”œâ”€â”€ ConfigManage.vue    # é…ç½®ç®¡ç†
â”‚   â”‚       â”‚   â”‚   â”œâ”€â”€ TableEditor.vue     # è¡¨ç¼–è¾‘å™¨
â”‚   â”‚       â”‚   â”‚   â”œâ”€â”€ DataEditor.vue      # æ•°æ®ç¼–è¾‘å™¨
â”‚   â”‚       â”‚   â”‚   â”œâ”€â”€ FieldEditor.vue     # å­—æ®µç¼–è¾‘å™¨
â”‚   â”‚       â”‚   â”‚   â”œâ”€â”€ FieldInput.vue      # å­—æ®µè¾“å…¥
â”‚   â”‚       â”‚   â”‚   â”œâ”€â”€ ArrayEditor.vue     # æ•°ç»„ç¼–è¾‘å™¨
â”‚   â”‚       â”‚   â”‚   â””â”€â”€ ObjectEditor.vue    # å¯¹è±¡ç¼–è¾‘å™¨
â”‚   â”‚       â”‚   â”‚
â”‚   â”‚       â”‚   â””â”€â”€ utils/        # å·¥å…·æ¨¡å—
â”‚   â”‚       â”‚       â”œâ”€â”€ types.ts           # ç±»å‹å®šä¹‰
â”‚   â”‚       â”‚       â”œâ”€â”€ dataManager.ts     # æ•°æ®ç®¡ç†
â”‚   â”‚       â”‚       â”œâ”€â”€ fieldFactory.ts    # å­—æ®µå·¥å‚
â”‚   â”‚       â”‚       â”œâ”€â”€ importHelper.ts    # å¯¼å…¥åŠ©æ‰‹
â”‚   â”‚       â”‚       â”œâ”€â”€ serializer.ts      # åºåˆ—åŒ–
â”‚   â”‚       â”‚       â”œâ”€â”€ importExamples.ts  # å¯¼å…¥ç¤ºä¾‹
â”‚   â”‚       â”‚       â””â”€â”€ InterfaceGenerator.ts  # TS æ¥å£ç”Ÿæˆå™¨
â”‚   â”‚       â”‚
â”‚   â”‚       â”œâ”€â”€ vite.config.ts    # Vite é…ç½®
â”‚   â”‚       â”œâ”€â”€ index.html        # HTML å…¥å£
â”‚   â”‚       â””â”€â”€ package.json      # Vue é¡¹ç›®é…ç½®
â”‚   â”‚
â”‚   â””â”€â”€ tools/                    # ç¼–è¾‘å™¨å·¥å…·ç±»
â”‚       â””â”€â”€ Tools.ts              # æ–‡ä»¶æ“ä½œã€åŒæ­¥ç­‰
â”‚
â”œâ”€â”€ electron/                     # Electron ç‹¬ç«‹æ‰“åŒ…
â”‚   â”œâ”€â”€ main.js                   # Electron ä¸»è¿›ç¨‹
â”‚   â”œâ”€â”€ preload.js                # é¢„åŠ è½½è„šæœ¬
â”‚   â””â”€â”€ package.json              # Electron é…ç½®
â”‚
â”œâ”€â”€ dist/                         # ç¼–è¯‘è¾“å‡º
â”‚   â”œâ”€â”€ v2/                       # v2 ç¼–è¯‘äº§ç‰©
â”‚   â”œâ”€â”€ v3/                       # v3 ç¼–è¯‘äº§ç‰©
â”‚   â””â”€â”€ vue-editor/               # Vue ç¼–è¾‘å™¨æ„å»ºäº§ç‰©
â”‚
â”œâ”€â”€ package.json                  # ä¸»é…ç½®ï¼ˆCocos 3.xï¼‰
â”œâ”€â”€ package.v2.json               # v2 ä¸“ç”¨é…ç½®
â”œâ”€â”€ package.v3.json               # v3 ä¸“ç”¨é…ç½®
â”œâ”€â”€ tsconfig.json                 # TypeScript åŸºç¡€é…ç½®
â”œâ”€â”€ tsconfig.v2.json              # v2 ç¼–è¯‘é…ç½®
â”œâ”€â”€ tsconfig.v3.json              # v3 ç¼–è¯‘é…ç½®
â”œâ”€â”€ README.md                     # é¡¹ç›®ç®€ä»‹
â”œâ”€â”€ ä½¿ç”¨è¯´æ˜.md                   # è¯¦ç»†æ–‡æ¡£
â””â”€â”€ é¡¹ç›®æ¶æ„è¯´æ˜.md               # æœ¬æ–‡æ¡£
```

### å›¾ä¾‹è¯´æ˜
- ğŸ”’ **æ¡†æ¶å±‚** - å·²å®Œæˆï¼Œå¼€å‘è€…æ— éœ€ä¿®æ”¹
- ğŸ”‘ **å¹³å°é€‚é…å±‚** - å…³é”®æ¨¡å—ï¼Œç»Ÿä¸€ä¸åŒè¿è¡Œç¯å¢ƒ
- â­ **ä¸šåŠ¡å±‚** - å¼€å‘è€…ä¸»è¦å·¥ä½œåŒº

---

## æ ¸å¿ƒæ¨¡å—

### 1. é€‚é…å™¨å·¥å‚ (core/factory.ts)

**èŒè´£**ï¼šæ ¹æ®ç‰ˆæœ¬åˆ›å»ºå¯¹åº”çš„é€‚é…å™¨å®ä¾‹

```typescript
export class AdapterFactory {
    static getInstance(): IAdapterManager {
        const version = VersionDetector.detect();
        if (version === CocosVersion.V2) {
            return new V2AdapterManager();
        } else {
            return new V3AdapterManager();
        }
    }
}

// ä½¿ç”¨æ–¹å¼
import { getEditor } from './index';
const editor = getEditor();  // è‡ªåŠ¨è¿”å›å¯¹åº”ç‰ˆæœ¬çš„é€‚é…å™¨
editor.log('Hello');         // ç»Ÿä¸€æ¥å£
```

### 2. ç‰ˆæœ¬æ£€æµ‹å™¨ (core/version-detector.ts)

**èŒè´£**ï¼šè‡ªåŠ¨æ£€æµ‹å½“å‰ Cocos Creator ç‰ˆæœ¬

```typescript
export class VersionDetector {
    static detect(): CocosVersion {
        if (typeof Editor === 'undefined') {
            return CocosVersion.Unknown;
        }
        
        const version = Editor.App?.version || '';
        if (version.startsWith('2.')) {
            return CocosVersion.V2;
        } else if (version.startsWith('3.')) {
            return CocosVersion.V3;
        }
        
        return CocosVersion.Unknown;
    }
}
```

### 3. æ•°æ®ç®¡ç†å™¨ (utils/dataManager.ts)

**èŒè´£**ï¼šç®¡ç†è¡¨æ ¼æ•°æ®çš„ CRUD æ“ä½œ

```typescript
export class DataManager {
    // è¡¨ç®¡ç†
    addTable(key: string, params: any): void
    updateTable(key: string, params: any): void
    deleteTable(key: string): void
    
    // æ•°æ®ç®¡ç†
    addData(tableKey: string, dataKey: string, data: any): void
    updateData(tableKey: string, dataKey: string, data: any): void
    deleteData(tableKey: string, dataKey: string): void
    
    // å¯¼å…¥å¯¼å‡º
    importTableFromJson(): Promise<void>
    exportTableToJson(tableKey: string): Promise<void>
    exportAllTables(): Promise<void>
    
    // æŒä¹…åŒ–
    load(filePath: string): Promise<void>
    save(): Promise<void>
}
```

### 4. å­—æ®µå·¥å‚ (utils/fieldFactory.ts)

**èŒè´£**ï¼šåˆ›å»ºä¸åŒç±»å‹çš„å­—æ®µå®šä¹‰

```typescript
export function createField(type: FieldType, params: any): IFieldDef {
    switch (type) {
        case 'string':
            return createStringField(params);
        case 'number':
            return createNumberField(params);
        case 'array':
            return createArrayField(params);
        case 'object':
            return createObjectField(params);
        // ...
    }
}

// é»˜è®¤å€¼è·å–
export function getDefaultValue(field: IFieldDef): any {
    // ç»Ÿä¸€å¤„ç†æ‰€æœ‰å­—æ®µç±»å‹çš„é»˜è®¤å€¼
}
```

### 5. åºåˆ—åŒ–å™¨ (utils/serializer.ts)

**èŒè´£**ï¼šæ•°æ®åŠ å¯†å’Œåºåˆ—åŒ–

```typescript
// åºåˆ—åŒ–ä¸ºåŠ å¯†äºŒè¿›åˆ¶
export function serializeDataSource(dataSource: IDataSource): ArrayBuffer {
    const json = JSON.stringify(dataSource);
    const encrypted = encryptData(json);
    const buffer = compressData(encrypted);
    return addMagicHeader(buffer);
}

// ååºåˆ—åŒ–
export function deserializeDataSource(buffer: ArrayBuffer): IDataSource {
    validateMagicHeader(buffer);
    const decrypted = decryptData(buffer);
    const decompressed = decompressData(decrypted);
    return JSON.parse(decompressed);
}
```

---

## å¼€å‘è§„èŒƒ

### å‘½åè§„èŒƒ

```typescript
// æ–‡ä»¶å¤¹ï¼šé©¼å³°å‘½å (camelCase)
src/panels/vueEditor/
src/utils/

// æ–‡ä»¶åï¼šé©¼å³°å‘½å (camelCase)ï¼Œå·¥å…·ç±»/ç”Ÿæˆå™¨å¯ç”¨å¤§é©¼å³° (PascalCase)
dataManager.ts
fieldFactory.ts
InterfaceGenerator.ts

// ç±»åï¼šå¤§é©¼å³°å‘½å (PascalCase)
class DataManager {}
class FieldFactory {}

// å‡½æ•°/æ–¹æ³•ï¼šé©¼å³°å‘½å (camelCase)
function handleCreateData() {}
async function importTableFromJson() {}

// å¸¸é‡ï¼šå…¨å¤§å†™ + ä¸‹åˆ’çº¿
const MAGIC_NUMBER = 0x5442_4C45;
const ENCRYPT_KEY = 'table_tool_2024';
```

### ä»£ç æ‹†åˆ†åŸåˆ™

- **å•æ–‡ä»¶ä¸è¶…è¿‡ 500 è¡Œ**
- æŒ‰èŒè´£æ‹†åˆ†æ¨¡å—
- ç±»å‹å®šä¹‰ç‹¬ç«‹æ–‡ä»¶

ç¤ºä¾‹ï¼š
```
dataManager.ts (928è¡Œ) â†’ æ‹†åˆ†ä¸ºï¼š
â”œâ”€â”€ types.ts                (170è¡Œ) - ç±»å‹å®šä¹‰
â”œâ”€â”€ fieldFactory.ts         (100è¡Œ) - å­—æ®µåˆ›å»º
â”œâ”€â”€ importHelper.ts         (180è¡Œ) - å¯¼å…¥é€»è¾‘
â”œâ”€â”€ serializer.ts           (110è¡Œ) - åºåˆ—åŒ–
â”œâ”€â”€ InterfaceGenerator.ts   (200è¡Œ) - TS æ¥å£ç”Ÿæˆ
â””â”€â”€ dataManager.ts          (330è¡Œ) - ä¸»é€»è¾‘
```

### TypeScript ä½¿ç”¨

```typescript
// âœ… å®Œæ•´çš„ç±»å‹å®šä¹‰
export interface IFieldDef {
    key: string;
    name: string;
    type: FieldType;
    defaultValue?: any;
}

// âœ… ç±»å‹å®‰å…¨çš„å‡½æ•°
export function createField(
    type: FieldType,
    params: IFieldParams
): IFieldDef {
    // ...
}

// âœ… æ³›å‹ä½¿ç”¨
export function getDefaultValue<T extends IFieldDef>(field: T): any {
    // ...
}
```

---

## æ•°æ®æµç¨‹

### æ•°æ®åŠ è½½æµç¨‹

```
1. ç”¨æˆ·æ“ä½œ
   â†“
2. Vue ç»„ä»¶ (DataEditor.vue)
   â†“
3. æ•°æ®ç®¡ç†å™¨ (dataManager.ts)
   â†“
4. åºåˆ—åŒ–å™¨ (serializer.ts)
   â†“
5. API é€‚é…å±‚ (api/index.ts)
   â†“
6. å¹³å°å®ç° (cocos.ts / electron.ts / standalone.ts)
   â†“
7. æ–‡ä»¶ç³»ç»Ÿ
```

### æ•°æ®ä¿å­˜æµç¨‹

```
1. ç”¨æˆ·ç‚¹å‡»ä¿å­˜
   â†“
2. dataManager.save()
   â†“
3. serializeDataSource(dataSource)
   â”œâ”€â”€ JSON.stringify()
   â”œâ”€â”€ encryptData()      # åŠ å¯†
   â”œâ”€â”€ compressData()     # å‹ç¼©
   â””â”€â”€ addMagicHeader()   # æ·»åŠ æ–‡ä»¶å¤´
   â†“
4. api.writeBinaryFile(path, buffer)
   â†“
5. å†™å…¥ .table æ–‡ä»¶
```

### å¯¼å…¥æµç¨‹

```
1. é€‰æ‹© JSON æ–‡ä»¶
   â†“
2. importHelper.parseJson()
   â”œâ”€â”€ åˆ¤æ–­æ•°æ®æ ¼å¼ï¼ˆå¯¹è±¡/æ•°ç»„ï¼‰
   â”œâ”€â”€ æ¨æ–­å­—æ®µç±»å‹
   â””â”€â”€ ç”Ÿæˆè¡¨å®šä¹‰
   â†“
3. dataManager.addTable()
   â†“
4. dataManager.forceRefresh()  # è§¦å‘ UI æ›´æ–°
   â†“
5. Vue å“åº”å¼æ›´æ–°
```

---

## å¼€å‘æŒ‡å—

### æ·»åŠ æ–°åŠŸèƒ½çš„æ­¥éª¤

#### 1. ç¡®å®šåŠŸèƒ½ä½ç½®
- **ç¼–è¾‘å™¨åŠŸèƒ½** â†’ `src/panels/vue-editor/src/components/`
- **æ•°æ®å¤„ç†** â†’ `src/panels/vue-editor/src/utils/`
- **å¹³å° API** â†’ `src/panels/vue-editor/src/api/`
- **ä¸»è¿›ç¨‹** â†’ `src/main.ts` + `src/adapters/`

#### 2. åˆ›å»ºç»„ä»¶/æ¨¡å—
```typescript
// ç¤ºä¾‹ï¼šæ·»åŠ æ–°çš„å­—æ®µç±»å‹ 'date'

// 1. æ›´æ–°ç±»å‹å®šä¹‰ (utils/types.ts)
export type FieldType = 'string' | 'number' | 'boolean' | 'date' | ...;

export interface IDateField extends IBaseField {
    type: 'date';
    format?: string;  // æ—¥æœŸæ ¼å¼
}

// 2. æ›´æ–°å­—æ®µå·¥å‚ (utils/fieldFactory.ts)
export function createDateField(params: any): IDateField {
    return {
        type: 'date',
        key: params.key,
        name: params.name,
        format: params.format || 'YYYY-MM-DD',
        defaultValue: new Date().toISOString()
    };
}

// 3. æ›´æ–° FieldInput ç»„ä»¶
<template>
  <input
    v-if="field.type === 'date'"
    type="date"
    :value="formatDate(value)"
    @input="handleDateInput"
  />
</template>
```

#### 3. æµ‹è¯•
```bash
# æµè§ˆå™¨æµ‹è¯•
npm run dev:editor

# Electron æµ‹è¯•
npm run dev:electron

# Cocos æ’ä»¶æµ‹è¯•
npm run build:v3
# ç„¶ååœ¨ Cocos Creator ä¸­é‡è½½æ’ä»¶
```

---

## å¸¸è§é—®é¢˜

### Q1: ä¸ºä»€ä¹ˆ Vue é¢æ¿ä¸èƒ½ç›´æ¥ä½¿ç”¨é€‚é…å™¨ï¼Ÿ

**A**: Vue é¢æ¿è¿è¡Œåœ¨ iframe æµè§ˆå™¨ç¯å¢ƒä¸­ï¼Œæ— æ³•è®¿é—® Node.js æ¨¡å—ã€‚é€‚é…å™¨å±‚ä½äºä¸»è¿›ç¨‹ï¼ˆNode.jsï¼‰ï¼Œéœ€è¦é€šè¿‡ IPC é€šä¿¡æ¡¥æ¥ã€‚

### Q2: å¦‚ä½•æ‰©å±•æ–°çš„å¹³å° APIï¼Ÿ

**A**: 
1. åœ¨ `api/index.ts` çš„ `IEditorApi` æ¥å£æ·»åŠ æ–¹æ³•
2. åœ¨ `standalone.ts`ã€`cocos.ts`ã€`electron.ts` ä¸­å®ç°
3. è‹¥éœ€ IPCï¼Œæ›´æ–° `electron/preload.js` å’Œ `src/main.ts`

### Q3: å¦‚ä½•è°ƒè¯•ï¼Ÿ

**A**:
- **æµè§ˆå™¨æ¨¡å¼**ï¼šä½¿ç”¨ Chrome DevTools
- **Electron æ¨¡å¼**ï¼šå¯ç”¨ DevToolsï¼ˆåœ¨ main.js ä¸­ï¼‰
- **Cocos æ¨¡å¼**ï¼šä½¿ç”¨ Cocos Creator çš„å¼€å‘è€…å·¥å…·

### Q4: å¦‚ä½•ä¼˜åŒ–å¤§æ•°æ®é‡ï¼Ÿ

**A**:
- ä½¿ç”¨è™šæ‹Ÿæ»šåŠ¨ï¼ˆVirtual Scrollï¼‰
- åˆ†é¡µåŠ è½½
- æ•°æ®æ‡’åŠ è½½
- Web Worker å¤„ç†å¤§æ•°æ®

---

## å‚è€ƒèµ„æ–™

- [README.md](./README.md) - é¡¹ç›®ç®€ä»‹
- [ä½¿ç”¨è¯´æ˜.md](./ä½¿ç”¨è¯´æ˜.md) - è¯¦ç»†ä½¿ç”¨æ–‡æ¡£
- [æ•°æ®ç®¡ç†æ¨¡å—è¯´æ˜](./src/panels/vue-editor/src/utils/README.md)
- [Cocos Creator 2.x æ–‡æ¡£](https://docs.cocos.com/creator/2.4/manual/)
- [Cocos Creator 3.x æ–‡æ¡£](https://docs.cocos.com/creator/3.8/manual/)

---

**æœ€åæ›´æ–°**ï¼š2026-02-08
**ç»´æŠ¤è€…**ï¼šoldP
